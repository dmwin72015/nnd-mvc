{"version":3,"sources":["webpack:///./appSrc/less/spider.less","webpack:///./appSrc/lib/dm-modals.js","webpack:///./appSrc/login/spider.js"],"names":[],"mappings":";;;;;AAAA,yC;;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;;AAEA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,SAAS;;AAET;;AAEA,SAAS;;AAET;AACA,kFAAkF;;AAElF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAAA;;;;;;;;;;;;;;;;;gEC5KD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;;AAEA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,mHAAmH;AACnH;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,iBAAiB;;AAEzC,aAAa;AACb;;AAEA;AACA,wBAAwB,yBAAyB;AACjD;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6DAA6D,iBAAiB;AAC9E;AACA,KAAK;AACL,CAAC;AAAA","file":"js/spider.bundle.js","sourcesContent":["// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./appSrc/less/spider.less\n// module id = 10\n// module chunks = 2","var _ = require('lodash');\r\nvar $ = require('../lib/jQuery-3.1.1.min.js');\r\nvar _locals = {\r\n    'zh_cn': {\r\n        B_Title: '标题'\r\n\r\n    },\r\n    'en': {\r\n        B_Title: 'title'\r\n    }\r\n};\r\n\r\n\r\ndefine('modals', function() {\r\n\r\n    function Modals(options) {\r\n        this.options = {\r\n            opacity: 0.4,\r\n            strict: true,\r\n            close: '.model-close',\r\n            wraper: 'body',\r\n            status: 'empty'\r\n        };\r\n\r\n        return this.init(_.assign({}, this.options, options));\r\n    }\r\n    /*\r\n        title --  string\r\n        class  ---   jira\r\n        opacity ---   0.4\r\n        head --- 头部\r\n        body  -- HTML 主要内容区域\r\n        foot --- \r\n        style ---- {color:red}\r\n        yes ---- 确定按钮  默认功能：隐藏弹框\r\n        no  ---- 取消按钮  默认功能：隐藏弹框\r\n        strict  ------ 严格 1 宽松 0 默认：1\r\n    \r\n        <div class=\"model-box box jira\">\r\n            <a href=\"javascript:;\" class=\"model-close\"></a>\r\n            <div class=\"box-head\">\r\n                <h3 class=\"title\">登录JIRA</h3>\r\n            </div>  \r\n            <div class=\"box-body\">\r\n                <p class=\"input-wraper\">\r\n                    <input type=\"text\"  name=\"jiraLoginName\" id=\"jira_name\" class=\"form-control\" placeholder=\"JIRA账号\">\r\n                </p>\r\n                <p class=\"input-wraper\">\r\n                    <input type=\"text\" name=\"jiraPassword\" id=\"jira_pwd\" class=\"form-control\" placeholder=\"JIRA密码\">\r\n                </p>\r\n                <p class=\"input-wraper\">\r\n                    <img src=\"http://tlc.xin.com/captcha?ts=\" alt=\"\" class=\"jira-imgCode\">\r\n                </p>\r\n                <p class=\"input-wraper\">\r\n                    <input type=\"button\" class=\"btn\" value=\"登录\" id=\"loginJira\">\r\n                </p>\r\n            </div>\r\n            <div class=\"box-foot\"></div>    \r\n        </div>\r\n    */\r\n\r\n    Modals.prototype = {\r\n        constructor: Modals,\r\n\r\n        init: function(options) {\r\n            this.options = options;\r\n            var that = this;\r\n            var head = options.head || {};\r\n            var body = options.body || {};\r\n\r\n            var _data = {\r\n                css: '',\r\n                body: {\r\n                    html: '',\r\n                    class: ''\r\n                },\r\n                head: {\r\n                    html: '',\r\n                    class: ''\r\n                },\r\n                foot: {\r\n                    html: '',\r\n                    class: ''\r\n                }\r\n            };\r\n\r\n            _data.title = options.title || head.title || '';\r\n            _data.css = options.css || '';\r\n            if (options.head) {\r\n                _data.head = _.assign(_data.head, options.head);\r\n            }\r\n\r\n            if (options.body) {\r\n                _data.body = _.assign(_data.body, options.body);\r\n            }\r\n            if (options.foot) {\r\n                _data.foot = _.assign(_data.foot, options.foot);\r\n            }\r\n\r\n            this.dom = $(this.render(options, _data));\r\n            this.wrapDom = $(this.options.wraper);\r\n            this.dom.on('click', this.options.close, function() {\r\n                that.hide();\r\n            });\r\n            if (options.btns) {\r\n                for (var btn in options.btns) {\r\n                    (function(btn) {\r\n                        that.dom.on('click', btn, function(ev) {\r\n                            options.btns[btn].apply(this, ev);\r\n                        });\r\n                    })(btn)\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n\r\n        show: function() {\r\n            if (this.options.status == 'empty') {\r\n                this.wrapDom.append(this.dom);\r\n                if(typeof this.options.aftershow == 'function'){\r\n                    this.options.aftershow.call(this);\r\n                }\r\n            }\r\n            this.wrapDom.show();\r\n            this.options.status = 'show';\r\n        },\r\n\r\n        hide: function() {\r\n            this.wrapDom.hide();\r\n            this.status = 'hide';\r\n        },\r\n\r\n        afterShow: function() {\r\n\r\n        },\r\n\r\n        render: function(options, data) {\r\n            var _html = '<div class=\"model-box box <%=css%>\"><a href=\"javascript:;\" class=\"model-close\"></a>';\r\n\r\n            if (data.title) {\r\n                _html += '<div class=\"box-head <%=head.class%>\"><h3 class=\"title\"><%=title%></h3></div>';\r\n            }\r\n            _html += '<div class=\"box-body\">' + (options.strict === false ? '<%= body.html %>' : '<%- body.html %>') + '</div>';\r\n\r\n            if (options.foot && options.foot.html) {\r\n                _html += '<div class=\"box-foot<%=foot.class%>\"><%- foot.html %></div>';\r\n            }\r\n            _html += '</div>';\r\n            var comp = _.template(_html);\r\n\r\n            this._tmpl = _html;\r\n            return comp(data).trim();\r\n        },\r\n\r\n        animate: function() {\r\n\r\n        },\r\n        destory: function() {\r\n            var that = this,\r\n                options = that.options;\r\n            this.dom.off('click', this.options.close);\r\n            if (options.btns) {\r\n                for (var btn in options.btns) {\r\n                    (function(btn) {\r\n                        that.dom.off('click', btn);\r\n                    })(btn);\r\n                }\r\n            }\r\n            this.dom.remove();\r\n        }\r\n    };\r\n    return Modals;\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./appSrc/lib/dm-modals.js\n// module id = 12\n// module chunks = 2","define('spider', ['../lib/jQuery-3.1.1.min.js', '../lib/dm-modals.js'], function($, modals) {\r\n    $(function() {\r\n        var $getBtn = $('#getJira');\r\n        var $jiraNo = $('#jiraNo');\r\n        $getBtn.on('click', function(ev) {\r\n            var jNo = $jiraNo.val();\r\n            if (!jNo) return;\r\n            getDataJira(jNo);\r\n        });\r\n\r\n        $('.spider-box').on('click', function(ev) {\r\n            var $target = $(ev.target);\r\n            var sClassName = ev.target.className;\r\n            if (sClassName.indexOf('j-toOut') != -1) {\r\n                // loginJira(ev);\r\n            } else if (sClassName.indexOf('j-toLogin') != -1) {\r\n                // quitJira(ev);\r\n            }\r\n        });\r\n        var loginModal = new modals({\r\n            title: '登录JIRA',\r\n            wraper: '.j-loginJira',\r\n            css: 'jira',\r\n            body: {\r\n                html: '<p class=\"input-wraper\"><input type=\"text\"  name=\"jiraLoginName\" id=\"jira_name\" class=\"form-control txt-input\" placeholder=\"JIRA账号\"></p><p class=\"input-wraper\"><input type=\"text\" name=\"jiraPassword\" id=\"jira_pwd\" class=\"form-control txt-input\" placeholder=\"JIRA密码\"></p><p class=\"input-wraper\"><input type=\"button\" class=\"btn\" value=\"登录\" id=\"loginJiraBtn\"></p>'\r\n            },\r\n            btns: {\r\n                '#loginJiraBtn': function(argument) {\r\n                    loginJira();\r\n                }\r\n            },\r\n            aftershow: function() {\r\n                $('#jira_name,#jira_pwd').focus(function() {\r\n                    $(this).removeClass('error');\r\n                    $('#loginJiraBtn').next().remove();\r\n                });\r\n                $('#jira_name').val('');\r\n                $('#jira_pwd').val('');\r\n            },\r\n            strict: false\r\n        });\r\n        var captcha = '<p class=\"input-wraper captcha\"><img src=\"http://tlc.xin.com/captcha?ts=' + Date.now() + '\" alt=\"\" class=\"jira-imgCode\"></p>';\r\n\r\n        $('.j-toLogin').click(function() {\r\n            loginModal.show();\r\n        });\r\n\r\n        var status = 'end';\r\n\r\n        function loginJira() {\r\n            if (status == 'run') return;\r\n            var $name = $('#jira_name');\r\n            var $pwd = $('#jira_pwd');\r\n            var result = validate($name, $pwd);\r\n            if (result.status) {\r\n                status = 'run';\r\n                $('#loginJiraBtn').val('登录中...');\r\n                jiraAction({\r\n                    'type': 'login',\r\n                    'jiraName': $name.val(),\r\n                    'jiraPwd': $pwd.val(),\r\n                    'captcha': ''\r\n                }, function(err, data) {\r\n                    if (err || data.status != 1) {\r\n                        errorTip(data);\r\n                        return;\r\n                    }else if (data.status == '1') {\r\n                        var time = data.data.time;\r\n                        var user = data.data.user;\r\n                        var sHtml = '<span class=\"jira-user\">' + user + '(' + time + ')</span><a href=\"javascript:;\" class=\"j-toOut\">退出jira</a>';\r\n                        $('.jira-status').html(sHtml);\r\n                        loginModal.hide();\r\n                    }\r\n                });\r\n                status = 'end';\r\n                $('#loginJiraBtn').val('登录');\r\n            }\r\n        }\r\n\r\n        function quitJira() {\r\n            jiraAction({ 'type': 'quit' }, function(err, data) {\r\n\r\n            });\r\n        }\r\n\r\n        function getDataJira(id) {\r\n            jiraAction({ 'type': 'jira', id: id }, function(err, data) {\r\n                console.log(data);\r\n            });\r\n        }\r\n\r\n        function jiraAction(opt, callback) {\r\n            $.ajax({\r\n                url: '/admin/spider/jira',\r\n                type: 'post',\r\n                data: Object.assign({}, opt),\r\n                success: function(data, status, xhr) {\r\n                    callback(null, data);\r\n                },\r\n                error: function(xhr, status, err) {\r\n                    callback(xhr);\r\n                }\r\n            });\r\n        }\r\n\r\n        function validate($name, $pwd) {\r\n            if ($name.val() == '') {\r\n                var errMsg = {\r\n                    status: false,\r\n                    id: '#jira_name',\r\n                    msg: '账号不能为空'\r\n                }\r\n                errorTip(errMsg)\r\n                return errMsg;\r\n\r\n            }\r\n            if ($pwd.val() == '') {\r\n                var errMsg = {\r\n                    status: false,\r\n                    id: '#jira_pwd',\r\n                    msg: '密码不能为空'\r\n                }\r\n                errorTip(errMsg)\r\n                return errMsg;\r\n            }\r\n            return {\r\n                status: true,\r\n                msg: 'success'\r\n            };\r\n        }\r\n\r\n        function errorTip(info) {\r\n            $('#loginJiraBtn').next().remove();\r\n            $(info.id).addClass('error');\r\n            $('#loginJiraBtn').after('<span style=\"color:red;margin-left:10px;\">' + info.msg + '</span>');\r\n        }\r\n    });\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./appSrc/login/spider.js\n// module id = 8\n// module chunks = 2"],"sourceRoot":""}